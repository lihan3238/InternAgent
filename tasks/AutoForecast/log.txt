<<<<<<< HEAD
/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
Traceback (most recent call last):
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 506, in <module>
    main()
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 419, in main
    tr_loss = train_epoch(model, train_loader, crit, opt, device)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 301, in train_epoch
    pred = model(xb)
           ^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 57, in forward
    spatial_attn_out, _ = self.spatial_attn(spatial_q, spatial_k, spatial_v)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 1488, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/functional.py", line 6296, in multi_head_attention_forward
    assert key.shape == value.shape, (
           ^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: key shape torch.Size([48, 2048, 7]) does not match value shape torch.Size([48, 2048, 128])

/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
Traceback (most recent call last):
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 506, in <module>
    main()
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 419, in main
    tr_loss = train_epoch(model, train_loader, crit, opt, device)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 301, in train_epoch
    pred = model(xb)
           ^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 62, in forward
    proj_q = self.temporal_query_proj(combined_q)  # project to d_model
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 134, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (98304x249 and 131x128)

/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
Traceback (most recent call last):
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 510, in <module>
    main()
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 423, in main
    tr_loss = train_epoch(model, train_loader, crit, opt, device)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 305, in train_epoch
    pred = model(xb)
           ^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 54, in forward
    x_embed = self.input_embedding(x)  # (B, L, d_model)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 134, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (98304x128 and 10x128)

=======
/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
Traceback (most recent call last):
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 506, in <module>
    main()
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 419, in main
    tr_loss = train_epoch(model, train_loader, crit, opt, device)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 301, in train_epoch
    pred = model(xb)
           ^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 57, in forward
    spatial_attn_out, _ = self.spatial_attn(spatial_q, spatial_k, spatial_v)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 1488, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/functional.py", line 6296, in multi_head_attention_forward
    assert key.shape == value.shape, (
           ^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: key shape torch.Size([48, 2048, 7]) does not match value shape torch.Size([48, 2048, 128])

/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
Traceback (most recent call last):
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 506, in <module>
    main()
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 419, in main
    tr_loss = train_epoch(model, train_loader, crit, opt, device)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 301, in train_epoch
    pred = model(xb)
           ^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 62, in forward
    proj_q = self.temporal_query_proj(combined_q)  # project to d_model
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 134, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (98304x249 and 131x128)

/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.num_heads is odd
  warnings.warn(
Traceback (most recent call last):
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 510, in <module>
    main()
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 423, in main
    tr_loss = train_epoch(model, train_loader, crit, opt, device)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 305, in train_epoch
    pred = model(xb)
           ^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/git_repos/interns/InternAgent/results/AutoForecast/20251111_120358_Enhanced Hybrid Weather-Aware Attention Forecasting (EHWAF)/./experiment.py", line 54, in forward
    x_embed = self.input_embedding(x)  # (B, L, d_model)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yxlu/anaconda3/envs/ai_scientist/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 134, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (98304x128 and 10x128)

>>>>>>> ssy
